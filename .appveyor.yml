# Continuous integration procedure for AppVeyor
# Based on https://github.com/rmcgibbo/python-appveyor-conda-example

environment:
  matrix:
  - PYTHON_VERSION: "3.6"
    MINICONDA: "C:\\Miniconda36-x64"
    PYTHON_ARCH: "64"
    # These correspond to folder naming of miniconda installs on AppVeyor.
    # See https://www.appveyor.com/docs/installed-software#python
    BASE_PYTHON_VERSION: '36'
    ARCH_LABEL: '-x64'

init:
  - "ECHO %PYTHON_VERSION% %MINICONDA%"

install:
  # These are already installed on appveyor.  Update them.
  - set "CONDA_ROOT=C:\Miniconda%BASE_PYTHON_VERSION%%ARCH_LABEL%"
  - set "PATH=%CONDA_ROOT%;%CONDA_ROOT%\Scripts;%CONDA_ROOT%\Library\bin;%PATH%"
  # Dependencies and package install
  - ps: Start-FileDownload 'https://d37drm4t2jghv5.cloudfront.net/distributions/25.1.1/windows/windows_x64_64.exe'
  - windows_x64_64.exe /SP- /VERYSILENT /NORESTART /DIR=.\gams /NOICONS
  - "SET PATH=%cd%\\gams;%PATH%"
  - pip install --upgrade --requirement ci/requirements.txt
  - pip install .[reporting,tests,tutorial]

build: false

test_script:
  - pytest -v tests
  - messageix-config --model_path=message_ix\\model
